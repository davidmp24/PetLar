{% extends 'index.html' %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center text-light">Cadastro de Adotante</h2>
    <div class="card p-4 shadow-lg bg-dark text-light">
        <form method="POST">
            <!-- ID do Adotante -->
            <div class="mb-3">
                <label for="adotante_id" class="form-label">ID do Adotante</label>
                <input type="text" class="form-control bg-secondary text-light" id="adotante_id" name="adotante_id" value="{{ proximo_id }}" readonly style="max-width: 100px;">
            </div>
            <!-- Informações Pessoais -->
            <h4 class="text-light">Informações Pessoais</h4>
            <div class="mb-3">
                <label for="nome_completo" class="form-label">Nome Completo</label>
                <input type="text" class="form-control bg-secondary text-light" id="nome_completo" name="nome_completo" required>
            </div>
            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="rg" class="form-label">RG</label>
                    <input type="text" class="form-control bg-secondary text-light" id="rg" name="rg" required>
                </div>
                <div class="col-md-6">
                    <label for="cpf" class="form-label">CPF</label>
                    <input type="text" class="form-control bg-secondary text-light" id="cpf" name="cpf" required onblur="validarCPF(this.value)">
                    <div id="cpf-error" class="text-danger"></div>
                </div>
            </div>

            <!-- Informações de Contato -->
            <h4 class="text-light mt-4">Contato</h4>
            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="cep" class="form-label">CEP</label>
                    <input type="text" class="form-control form-control-sm bg-secondary text-light" id="cep" name="cep" required>
                    <div id="cep-error" class="text-danger"></div>
                </div>
                    <button type="button" class="btn btn-primary w-200" required readonly style="max-width: 200px;" onclick="buscarEndereco(document.getElementById('cep').value)">
                        <i class="fas fa-search"></i> Buscar CEP
                    </button>                                          
            </div>            
            <div class="mb-3">
                <label for="endereco" class="form-label">Endereço</label>
                <input type="text" class="form-control bg-secondary text-light" id="endereco" name="endereco" required>
            </div>
            <div class="row mb-3">
                <div class="col-md-4">
                    <label for="bairro" class="form-label">Bairro</label>
                    <input type="text" class="form-control bg-secondary text-light" id="bairro" name="bairro" required>
                </div>
                <div class="col-md-4">
                    <label for="cidade" class="form-label">Cidade</label>
                    <input type="text" class="form-control bg-secondary text-light" id="cidade" name="cidade" required>
                </div>
            </div>
            
             <div class="mb-3">
                <label for="email" class="form-label">Email</label>
                <input type="email" class="form-control bg-secondary text-light" id="email" name="email" required>
            </div>
            <div class="mb-3">
                <label for="telefone" class="form-label">Telefone</label>
                <input type="text" class="form-control bg-secondary text-light" id="telefone" name="telefone" required>
            </div>

            <!-- Informações sobre Interesse em Adoção -->
            <h4 class="text-light mt-4">Interesse em Adoção</h4>
            <div class="mb-3">
                <label for="animal_interesse" class="form-label">Animal de Interesse (Nome)</label>
                <input type="text" class="form-control bg-secondary text-light" id="animal_interesse" name="animal_interesse" required>
            </div>
            <div class="mb-3">
                <label for="tipo_animal_interesse" class="form-label">Tipo de Animal de Interesse</label>
                <select class="form-select bg-secondary text-light" id="tipo_animal_interesse" name="tipo_animal_interesse" required>
                    <option value="" disabled selected>Selecione</option>
                    <option value="Cachorro">Cachorro</option>
                    <option value="Gato">Gato</option>
                    <option value="Ave">Ave</option>
                    <option value="Outro">Outro</option>
                </select>
            </div>

            <div class="mb-3">
                <label for="justificativa_adocao" class="form-label">Por que você deseja adotar?</label>
                <textarea class="form-control bg-secondary text-light" id="justificativa_adocao" name="justificativa_adocao" rows="3" required></textarea>
            </div>

            <!-- Questionário (Opcional, mas importante para adoção responsável) -->
            <h4 class="text-light mt-4">Questionário</h4>
            <div class="mb-3">
                <label class="form-label">Você tem outros animais em casa?</label>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="tem_outros_animais" id="tem_outros_animais_sim" value="Sim" onclick="mostrarCamposAnimais()">
                    <label class="form-check-label" for="tem_outros_animais_sim">Sim</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="tem_outros_animais" id="tem_outros_animais_nao" value="Nao" onclick="esconderCamposAnimais()" checked>
                    <label class="form-check-label" for="tem_outros_animais_nao">Não</label>
                </div>
            </div>
    
            <!-- Campos adicionais (inicialmente escondidos) -->
            <div id="campos_animais" style="display: none;">
                <div class="mb-3">
                    <label for="quantidade_animais" class="form-label">Quantidade de animais que você possui</label>
                    <input type="number" class="form-control bg-secondary text-light" id="quantidade_animais" name="quantidade_animais" min="1" placeholder="Ex: 2">
                </div>
                <div class="mb-3">
                    <label for="tipos_animais" class="form-label">Quais animais você possui?</label>
                    <input type="text" class="form-control bg-secondary text-light" id="tipos_animais" name="tipos_animais" placeholder="Ex: Cachorro, Gato, Pássaro">
                </div>
            </div>

            <div class="mb-3">
                <label for="tempo_sozinho" class="form-label">Quantas horas por dia o animal ficaria sozinho?</label>
                <input type="number" class="form-control bg-secondary text-light" id="tempo_sozinho" name="tempo_sozinho" min="0" placeholder="Ex: 4">
            </div>

             <!-- Upload de Foto -->
             <h4 class="text-light mt-4">Foto</h4>
             <div class="mb-3">
                 <input type="file" class="form-control bg-secondary text-light" id="foto" name="foto" accept="image/*" onchange="previewImage(event)">
                 <div class="mt-3 text-center">
                     <img id="preview" src="#" class="img-thumbnail d-none" style="max-width: 150px;">
                     <button type="button" class="btn btn-danger btn-sm d-none" id="removeImage" onclick="removePreview()">Remover</button>
                 </div>
             </div>
             
             <div class="d-flex justify-content-between">
                 <button type="submit" class="btn btn-primary">Cadastrar</button>
                 <button type="reset" class="btn btn-secondary" onclick="resetForm()">Limpar</button>
             </div>
         </form>
     </div>
 </div>
 
 <script>
    //----------------------------------------------------------------------------------------------------
    // Busca de CEP
    function buscarEndereco(cep) {
        fetch(`https://brasilapi.com.br/api/cep/v2/${cep}`)
            .then(response => {
                if (response.status === 200) {
                    return response.json();
                } else {
                    document.getElementById('endereco').value = '';
                    document.getElementById('bairro').value = '';
                    document.getElementById('cidade').value = '';
                    document.getElementById('cep-error').textContent = 'CEP não encontrado';
                }
            })
            .then(data => {
                document.getElementById('endereco').value = data.street;
                document.getElementById('bairro').value = data.neighborhood;
                document.getElementById('cidade').value = data.city;
                document.getElementById('cep-error').textContent = '';
            })
            .catch(error => {
                document.getElementById('cep-error').textContent = 'CEP não encontrado';
            });
    }
    //----------------------------------------------------------------------------------------------------
    //Validação do CPF //
    //function validarCPF(cpf) {
    //    fetch(`https://brasilapi.com.br/api/cpf/v1/${cpf}`)
    //            if (response.status === 200) {
    //                document.getElementById('cpf-error').textContent = '';
    //            } else {
     //               document.getElementById('cpf-error').textContent = 'CPF inválido';
    //            }
     //       })
    //        .catch(error => {
    //            document.getElementById('cpf-error').textContent = 'Erro ao validar CPF';
    //        });
    //}
   
     //----------------------------------------------------------------------------------------------------
     function previewImage(event) {
         const preview = document.getElementById('preview');
         const removeButton = document.getElementById('removeImage');
         preview.src = URL.createObjectURL(event.target.files[0]);
         preview.classList.remove('d-none');
         removeButton.classList.remove('d-none');
     }
     //----------------------------------------------------------------------------------------------------
     function removePreview() {
         document.getElementById('foto').value = "";
         document.getElementById('preview').classList.add('d-none');
         document.getElementById('removeImage').classList.add('d-none');
     }
     //----------------------------------------------------------------------------------------------------
     function resetForm() {
         document.getElementById('preview').classList.add('d-none');
         document.getElementById('removeImage').classList.add('d-none');
     }
     //----------------------------------------------------------------------------------------------------
     function mostrarCamposAnimais() {
         document.getElementById('campos_animais').style.display = 'block';
     }
     //----------------------------------------------------------------------------------------------------
     function esconderCamposAnimais() {
         document.getElementById('campos_animais').style.display = 'none';
         document.getElementById('quantidade_animais').value = '';
         document.getElementById('tipos_animais').value = '';
     }
     //----------------------------------------------------------------------------------------------------
 </script>
 {% endblock %}